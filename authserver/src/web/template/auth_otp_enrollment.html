{{define "title"}}{{ .appName }} - OTP{{end}}
{{define "head"}}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        focusOnFirstNonEmptyInput("form-auth")
    });        
</script>
{{end}}

{{define "body"}}

<div class="min-h-screen bg-base-200 flex items-center">
    <div class="card mx-auto w-full max-w-5xl shadow-xl">
        <div class="grid  md:grid-cols-2 grid-cols-1  bg-base-100 rounded-xl">

            {{template "left_panel" . }}

            <div class='py-6 px-10'>
                <h2 class='text-2xl font-semibold mb-2 text-center'>One-time password (OTP) enrollment</h2>
                <form id="form-auth" action="" method="post">

                    <div class="mb-3">

                        <p class="mt-5">To continue, we require you to enroll in two factor
                            authentication using the one-time password (OTP) method. Please follow these steps:</p>

                        <p class="mt-2"><strong>1.</strong> Download and install an OTP-compatible authenticator app to
                            your smartphone or device, such as <a
                                href="https://www.microsoft.com/en/security/mobile-authenticator-app"><span
                                    class="text-primary inline-block  hover:text-primary hover:underline hover:cursor-pointer transition duration-200">Microsoft
                                    Authenticator</span></a>, <a
                                href="https://support.google.com/accounts/answer/1066447"><span
                                    class="text-primary inline-block  hover:text-primary hover:underline hover:cursor-pointer transition duration-200">Google
                                    Authenticator</span></a> or <a href="https://freeotp.github.io/"><span
                                    class="text-primary inline-block  hover:text-primary hover:underline hover:cursor-pointer transition duration-200">FreeOTP</span></a>.
                        </p>

                        <p class="mt-2"><strong>2.</strong> Scan this QR code using your authenticator app:</p>

                        <img class="mt-4 mx-auto border" src="data:image/png;base64,{{.base64Image}}" alt="OTP QR code" />

                        <p class="mt-2">If you're unable to scan the QR code, you can alternativelly enter the OTP secret into your app:</p>
                        <pre class="text-center mt-2">{{.secretKey}}</pre>

                        <p class="mt-2"><strong>3.</strong> To finish enrolling, enter your app's verification code:</p>

                        <div class="form-control w-full mt-4">                           
                            <input type="text" name="otp" value="" placeholder="123456" 
                                class="input  input-bordered w-full" />
                        </div>

                    </div>

                    {{if .error}}
                        <p class="text-center text-error mt-2">{{.error}}</p>
                    {{end}}

                    <button type="submit" class="btn mt-2 w-full btn-primary">Verify</button>

                    {{ .csrfField }}

                </form>
            </div>
        </div>
    </div>
</div>

{{end}}